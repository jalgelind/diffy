TODO:

    Clean up the tokenizer and make it a state machine